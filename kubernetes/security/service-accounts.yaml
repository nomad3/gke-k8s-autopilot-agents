# Kubernetes Service Accounts with Workload Identity

# ========================================
# Backend Namespace Service Account
# ========================================

---
apiVersion: v1
kind: ServiceAccount
metadata:
  name: dev-backend-sa
  namespace: backend
  annotations:
    # Workload Identity binding to GCP service account
    iam.gke.io/gcp-service-account: dev-backend-app@PROJECT_ID.iam.gserviceaccount.com  # Replace PROJECT_ID
  labels:
    app: backend
    environment: dev

---
# ========================================
# Frontend Namespace Service Account
# ========================================

apiVersion: v1
kind: ServiceAccount
metadata:
  name: dev-frontend-sa
  namespace: frontend
  annotations:
    iam.gke.io/gcp-service-account: dev-frontend-app@PROJECT_ID.iam.gserviceaccount.com  # Replace PROJECT_ID
  labels:
    app: frontend
    environment: dev

---
# ========================================
# Database Namespace Service Account
# ========================================

apiVersion: v1
kind: ServiceAccount
metadata:
  name: dev-database-sa
  namespace: database
  annotations:
    iam.gke.io/gcp-service-account: dev-database-app@PROJECT_ID.iam.gserviceaccount.com  # Replace PROJECT_ID
  labels:
    app: database
    environment: dev

---
# ========================================
# Monitoring Namespace Service Account
# ========================================

apiVersion: v1
kind: ServiceAccount
metadata:
  name: monitoring-sa
  namespace: monitoring
  annotations:
    iam.gke.io/gcp-service-account: gke-autopilot-cluster-monitoring@PROJECT_ID.iam.gserviceaccount.com  # Replace PROJECT_ID
  labels:
    app: monitoring
    environment: dev
